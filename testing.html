<html>
    <head>
        <title>TableTest</title>
    <style>
    .btnstyle{
    background-color: greenyellow;
    font-size: 20px;
    padding:8px;
    width:10%;
    border-radius: 12px;
    border: 5px solid #f70404;
    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
    text-align:center;
    
    }
    .btnstyle:hover{
    background-color: #11eeee; /* Green */
    color: rgb(85, 26, 12);
    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
    }
    .btnstyle:active {
    background-color: #16eaf1;
    box-shadow: 0 5px rgb(12, 10, 10);
    transform: translateY(4px);
    }
    body {
    background-image:url(space.jpg);
    background-repeat:repeat;
    height:100%;
    background-position:center;
    background-size:cover;
    }
    .header{
    font-size:large;
    text-align: center;
    text-decoration: dotted;
    text-shadow:0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
    }
    .func{
    color:"yellow";
    }
    
    </style>
    <div class="header">
    <h1 style="color:rgb(221, 94, 115)"
    style="font-family:Arial, Helvetica, sans-serif"
    >EARNED VALUE ANALYSIS TABLE</h1>
    </div>
       
    </head>
    <body>  
    <script >
       
        function addRow(tableID) {
    
            var table = document.getElementById(tableID);
    
            var rowCount = table.rows.length;
            var row = table.insertRow(rowCount);
    
            var colCount = table.rows[0].cells.length;
    
            for(var i=0; i<colCount-1; i++) {
    
                var newcell = row.insertCell(i);
    
                newcell.innerHTML = table.rows[1].cells[i].innerHTML;
                //alert(newcell.childNodes);
                switch(newcell.childNodes[0].type) {
                    case "text":
                            newcell.childNodes[0].value = "";
                            break;
                    case "checkbox":
                            newcell.childNodes[0].checked = false;
                            break;
                }
            }
        }
    
       
    var data=[];
    
       function getData() {
    
         var table = document.getElementById('dataTable');
         if (table === null)
             return;
    
         if (table.rows[0].cells.length <= 1)
             return;
    
         var data = [];
         for (l = 0; l < table.rows[0].cells.length; l++) {
             data.push({
                 items: [],
                 name: "ColumnNumber" + l
             });
         }0
    
         for (i = 1; i < table.rows.length; i++) {
             var cells = table.rows[i].cells;
             for (c = 0; c < cells.length; c++) {
                 var inputElem = cells[c].children[0];
                 data[c].items.push({
                     inputType: inputElem.getAttribute('type'),
                     inputValue: inputElem.value
                 });
             }
         }
         printData(data);
         bcws(data);
         bcwp(data);
         acwp(data);
         spi(data);
         sv(data);
         bac(data);
         psfc(data);
         pc(data);
         cpi(data);
         cv(data);
     }
    
     function printData(data) {
         for (i = 0; i < data.length; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 console.log(data[i].items[k].inputValue);
             }
         }
     }
     function bcws(data)
    { var sumval =0;
     for (i = 1; i < 2; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 sumval=sumval+parseFloat(data[i].items[k].inputValue);
    }
    }
    console.log(sumval);
    document.getElementById("bcws").innerHTML = "BUDGET COST OF WORK SHEDULE(BCWS)="+sumval;
    }
    function acwp(data)
    {
    var sumval1=0;
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval1=sumval1;
    }
    else
    {
       
                 sumval1=sumval1+parseFloat(data[i].items[k].inputValue);
    }
    
    }
    }
    console.log(sumval1);
    document.getElementById("acwp").innerHTML = "ACTUAL COST OF WORK PERFORMED(ACWP)="+sumval1;
    }
     function bcwp(data)
    { var sumval3 =0;
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval3=sumval3;
    }
    else
    {
       
                 sumval3=sumval3+parseFloat(data[1].items[k].inputValue);
    }
    
    }
    }
     
    console.log(sumval3);
    document.getElementById("bcwp").innerHTML = "BUDGET COST OF WORK PERFORMED="+sumval3;
    }
    function spi(data)
    { var sumval3=0;
    var sumval = 0;
    var sumval4 = 0;
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval3=sumval3;
    }
    else
    {
       
                 sumval3=sumval3+parseFloat(data[1].items[k].inputValue);
    }
    
    }
    }
     for (i = 1; i < 2; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 sumval=sumval+parseInt(data[i].items[k].inputValue);
    }
    }
    sumval4 = sumval3/sumval;
    console.log(sumval4);
    document.getElementById("spi").innerHTML = "SPI="+sumval4;
    }
    function sv(data)
    { var sumval3 =0;
    var sumval = 0;
    var sumval5 = 0;
     for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval3=sumval3;
    }
    else
    {
       
                 sumval3=sumval3+parseFloat(data[1].items[k].inputValue);
    }
    }
    }
    for (i = 1; i < 2; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 sumval=sumval+parseFloat(data[i].items[k].inputValue);
    }
    }
    sumval5 = sumval3-sumval;
    console.log(sumval5);
    document.getElementById("sv").innerHTML = "SHEDULE VARIANCE(SV)="+sumval5;
    
    }
    function bac(data)
    {
    var sumval7=0;
    for (i = 3; i < 4; i++) {
             for (k = 0; k < 1; k++) {
       
                 sumval7=sumval7+parseFloat(data[i].items[k].inputValue);
    }
    }
    console.log(sumval7);
    document.getElementById("bac").innerHTML = "BUDGET AT COMPLETION(BAC)="+ sumval7;
    }
    function psfc(data)
    { var sumval =0;
    var sumval6 = 0;
    var sumval7=0;
    for (i = 1; i < 2; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 sumval=sumval+parseFloat(data[i].items[k].inputValue);
    }
    }
    for (i = 3; i < 4; i++) {
             for (k = 0; k < 1; k++) {
       
                 sumval7=sumval7+parseFloat(data[i].items[k].inputValue);
    }
    }
    
    
    sumval6 = sumval/sumval7;
    console.log(sumval6);
    document.getElementById("psfc").innerHTML = "PERCENT SCHEDULE FOR COMPLETION(PSFC)="+sumval6;
    }
    function pc(data)
    { var sumval3 =0;
    var sumval8 = 0;
    var sumval7 = 0;
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval3=sumval3;
    }
    else
    {
       
                 sumval3=sumval3+parseFloat(data[1].items[k].inputValue);
    }
    
    }
    }
    for (i = 3; i < 4; i++) {
             for (k = 0; k < 1; k++) {
       
                 sumval7=sumval7+parseInt(data[i].items[k].inputValue);
    }
    }
    sumval8 = sumval3/sumval7;
    console.log(sumval8);
    document.getElementById("pc").innerHTML = "PERCENT COMPLETE(PC)="+sumval8;
    }
    function cpi(data)
    { var sumval3 =0;
    var sumval1 = 0;
    var sumval9 = 0;
     for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval3=sumval3;
    }
    else
    {
       
                 sumval3=sumval3+parseFloat(data[1].items[k].inputValue);
    }
    }
    }
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval1=sumval1;
    }
    else
    {
       
                 sumval1=sumval1+parseFloat(data[i].items[k].inputValue);
    }
    
    }
    }
    sumval9 = sumval3/sumval1;
    console.log(sumval9);
    document.getElementById("cpi").innerHTML = "COST PERFORMANCE INDEX(CPI)="+sumval9;
    }
    function cv(data)
    { var sumval3 =0;
    var sumval1 = 0;
    var sumval10 = 0;
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval3=sumval3;
    }
    else
    {
       
                 sumval3=sumval3+parseFloat(data[1].items[k].inputValue);
    }
    }
    }
    for (i = 2; i < 3; i++) {
             for (k = 0; k < data[i].items.length; k++) {
                 if(data[i].items[k].inputValue == '-'  )
                 
    {
    sumval1=sumval1;
    }
    else
    {
       
                 sumval1=sumval1+parseFloat(data[i].items[k].inputValue);
    }
    
    }
    }
    sumval10 = sumval3-sumval1;
    console.log(sumval10);
    document.getElementById("cv").innerHTML = "COST VARIANCE(CV)="+sumval10;
    }
     
    
    document.addEventListener("DOMContentLoaded", getData(), false);
           
    
    </script>
    <form>
    <div id="Input">
    
    
    <table id="dataTable" border="20 " style="width:70% ;color: rgb(154, 181, 192);size:30px;border-color:yellow" id="mytable" align="center" cellspacing="3" cellpadding="4">
    <th style="width:5%; text-align:centre;color:yellow;font-size:20px">Select</th>
    <th style="width:15%; color:yellow;font-size:20px">PLANNED EFFECT</th>
    <th style="width:20%; color:yellow;font-size:20px">ACTUAL EFFECT</th>
    <th style="width:25%; color:yellow;font-size:20px">BAC</th>
    <tr >
    <td><INPUT type="checkbox" style="background-color: rgb(110, 193, 196); padding:10px ;border:1000px;border-color:rgb(233, 235, 232); width:30%"name="chk"/></td>
    <td><INPUT type="text" style="background-color:rgb(110, 193, 196) ;padding:10px ;border:1000px;border-color:rgb(233, 235, 232); width:30%" name="text1"/></td>
    <td><INPUT type="text" style="background-color: rgb(110, 193, 196) ;padding:10px ;border:1000px;border-color:rgb(233, 235, 232); width:30%" name="txt2"/>
   <INPUT id="AddRow" type="button" style="width:40%" class="btnstyle" value="Add Row" onclick="addRow('dataTable')" />
   <td><INPUT type="text" style="background-color: rgb(110, 193, 196) ;padding:10px ;border:1000px;border-color:rgb(233, 235, 232); width:30%" name="tx2"/>
    
    </td></tr>
    </table>
    </div>
    <INPUT id="Finished" type="button" style="margin-left:70%;margin-top:5% " class="btnstyle" value="PROCEED" onclick="getData('dataTable')" />
    </form>
    
    <div >
    <p style=" margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
   
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;" id="bcws"></p>
    <p style="  margin: 300px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="acwp"></p>
    <p style="  margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="bcwp"></p>
    <p style="  margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="spi"></p>
    <p style=" margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="sv"></p>
    <p style=" margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="bac"></p>
    <p style=" margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="psfc"></p>
    <p style=" margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="pc"></p>
    <p style="  margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="cpi"></p>
    <p style=" margin: 300px;margin-top:1px;
    background:yellow;
    width:50%;text-align:center;font-size:30px;
    outline: 1px solid rgb(237, 240, 240);
    outline-offset: 15px;"id="cv"></p>
    </div>
    <div >
    <nav>
        <a href="./check.html">
          <button style ="margin-left:70%;margin-top:5% " class="btnstyle">FINISH</button></a>
      </nav>
    </div>
    </html>